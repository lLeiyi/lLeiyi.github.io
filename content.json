{"meta":{"title":"lLeiyi的博客","subtitle":null,"description":null,"author":"lLeiyi","url":"http://yoursite.com"},"pages":[{"title":"分类","date":"2018-07-15T16:38:36.000Z","updated":"2018-07-16T16:20:54.283Z","comments":true,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"标签","date":"2018-07-16T16:31:45.000Z","updated":"2018-07-16T16:32:05.154Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"ArcEngine中featurecursor分别在sde数据库和gdb数据库下的遍历问题","slug":"featurecursor分别在sde数据库和gdb数据库下的遍历问题","date":"2018-11-20T03:18:42.163Z","updated":"2018-11-20T03:27:54.255Z","comments":true,"path":"2018/11/20/featurecursor分别在sde数据库和gdb数据库下的遍历问题/","link":"","permalink":"http://yoursite.com/2018/11/20/featurecursor分别在sde数据库和gdb数据库下的遍历问题/","excerpt":"","text":"问题描述123456//一般的循环遍历步骤IFeatureCursor featureCursor = featureClass.Search(null,false);IFeature feature = null;while((feature = featureCursor.NextFeature())!=null)&#123;&#125; 以上是常用的循环遍历的步骤，最后遍历到feature为null后退出while循环，这时如果再执行一次featureCursor.NextFeature()语句： 1.在gdb和mdb数据库下会得到null； 2.在sde数据库下会得到“调用的函数顺序有误 [Function called out of sequence]”的报错。","categories":[{"name":"记录&&踩过的坑","slug":"记录-踩过的坑","permalink":"http://yoursite.com/categories/记录-踩过的坑/"},{"name":"ArcEngine","slug":"记录-踩过的坑/ArcEngine","permalink":"http://yoursite.com/categories/记录-踩过的坑/ArcEngine/"}],"tags":[{"name":"ArcEngine","slug":"ArcEngine","permalink":"http://yoursite.com/tags/ArcEngine/"},{"name":"IFeaturecursor","slug":"IFeaturecursor","permalink":"http://yoursite.com/tags/IFeaturecursor/"}]},{"title":"ArcEngine中打开各种数据源（WorkSpace）的连接","slug":"IWorkspace的创建问题","date":"2018-11-19T09:23:53.307Z","updated":"2018-11-20T03:27:53.589Z","comments":true,"path":"2018/11/19/IWorkspace的创建问题/","link":"","permalink":"http://yoursite.com/2018/11/19/IWorkspace的创建问题/","excerpt":"","text":"1.创建workspacefactory1234567891011//方式1Type factoryGDBType = Type.GetTypeFromProgID(&quot;esriDataSourcesGDB.FileGDBWorkspaceFactory&quot;);Type factorySDEType = Type.GetTypeFromProgID(&quot;esriDataSourcesGDB.SdeWorkspaceFactory&quot;);Type factoryMDBType = Type.GetTypeFromProgID(&quot;esriDataSourcesGDB.AccessWorkspaceFactory&quot;);IWorkspaceFactory workspaceFactory = (IWorkspaceFactory)Activator.CreateInstance(factory***Type);------------------------------------------------------------------------------------------------------//方式2IWorkspaceFactory wksGDBFactory = new FileGDBWorkspaceFactoryClass();IWorkspaceFactory wksSDEFactory = new SdeWorkspaceFactoryClass();IWorkspaceFactory wksMDBFactory = new AccessWorkspaceFactoryClass(); 2.调用workspacefactory的方法打开123456789101112//SDE连接信息IPropertySet propSet=new PropertySetClass();propSet.SetProperty(&quot;server&quot;,&quot;服务器机器名&quot; );propSet.SetProperty(&quot;instance&quot;,&quot;SDE运行的端口号&quot;);propSet.SetProperty(&quot;user&quot;,&quot;用户名&quot;);propSet.SetProperty(&quot;password&quot;,&quot;口令&quot; );propSet.SetProperty(&quot;password&quot;,&quot;口令&quot; );IWorkspace wks = wksFactory.Open(propSet, 0);//MDB,GDB文件路径string strDbPath = &quot;文件路径&quot;;IWorkspace wks = wksFactory.OpenFromFile(strDbPath, 0); PS：获取MDB，GDB文件路径时要注意，“右键数据库文件=》属性=》安全=》对象名称”，此处的文件路径有问题，如要选路径可从资源管理器的文件路径复制。","categories":[{"name":"记录&&踩过的坑","slug":"记录-踩过的坑","permalink":"http://yoursite.com/categories/记录-踩过的坑/"},{"name":"ArcEngine","slug":"记录-踩过的坑/ArcEngine","permalink":"http://yoursite.com/categories/记录-踩过的坑/ArcEngine/"}],"tags":[{"name":"ArcEngine","slug":"ArcEngine","permalink":"http://yoursite.com/tags/ArcEngine/"},{"name":"IWorkspace","slug":"IWorkspace","permalink":"http://yoursite.com/tags/IWorkspace/"}]},{"title":"ArcEngine中IMap的选择集刷新问题","slug":"IMap的选择集刷新问题","date":"2018-07-16T15:33:46.140Z","updated":"2018-11-20T03:27:52.668Z","comments":true,"path":"2018/07/16/IMap的选择集刷新问题/","link":"","permalink":"http://yoursite.com/2018/07/16/IMap的选择集刷新问题/","excerpt":"","text":"1.问题描述通过以下方式可以很便捷的往选择集内添加要素，但是却无法触发AxMapControl下的OnSelectionChanged事件。 12345678910111213public static void SelectFeatures(IFeatureLayer featureLayer, int[] OIDs)&#123; if (pFeatureLayer == null || OIDs == null) &#123; return; &#125; IFeatureSelection featureSelection = featureLayer as IFeatureSelection; if (featureSelection != null) &#123; IGeoDatabaseBridge2 geoDatabaseBridge2 = new GeoDatabaseHelperClass(); geoDatabaseBridge2.AddList(featureSelection.SelectionSet, ref OIDs); &#125;&#125; 2.通过ISelectEvents接口解决可以通过ISelectEvents接口来解决这个问题,该接口可由IMap接口QI。 12345ISelectionEvents selectEvents = map as ISelectionEvents;if (selectEvents != null)&#123; selectEvents.SelectionChanged();&#125;","categories":[{"name":"记录&&踩过的坑","slug":"记录-踩过的坑","permalink":"http://yoursite.com/categories/记录-踩过的坑/"},{"name":"ArcEngine","slug":"记录-踩过的坑/ArcEngine","permalink":"http://yoursite.com/categories/记录-踩过的坑/ArcEngine/"}],"tags":[{"name":"ArcEngine","slug":"ArcEngine","permalink":"http://yoursite.com/tags/ArcEngine/"},{"name":"ISelectEvents","slug":"ISelectEvents","permalink":"http://yoursite.com/tags/ISelectEvents/"}]}]}